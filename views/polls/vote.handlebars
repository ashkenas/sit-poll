<h1>{{poll.title}}</h1>
<h2>By {{author}}</h2>
<form id="vote-form">
    {{#each poll.choices}}
        <input type="radio" id="vote{{@index}}" name="vote" value="{{@index}}" {{#if (equals ../lastVote @index)}}checked{{/if}}>
        <label for="vote{{@index}}">{{this}}</label>
    {{/each}}
    <p id="options-error" class="error"></p>
    <input type="submit" value="Vote">
</form>
<script>
const showVoteError = errorManager('options-error');

handleForm('vote-form', 'POST', '/polls/{{poll._id}}', (formData) => {
    const vote = formData.get('vote');

    if (vote === null) {
        showVoteError('An option must be selected.');
        return;
    }

    showVoteError(); // Hides error info if no error

    return { vote: +vote };
});
</script>